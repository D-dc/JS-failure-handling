<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Temperature</title>

</head>

<body>
    

    <script src="../reflect.js"></script>
    <script src="nodeHandling.js"></script>
    <script type="text/javascript">

var TimeOutError = function (message) {
    this.name = 'TimeOutError';
    this.message = (message || '');
};

TimeOutError.prototype = new Error();
TimeOutError.prototype.constructor = TimeOutError;

////////

var FunctionNotFoundError = function (message) {
    this.name = 'FunctionNotFoundError';
    this.message = (message || '');
};

FunctionNotFoundError.prototype = new Error();
FunctionNotFoundError.prototype.constructor = FunctionNotFoundError;

////////

var ExpectedNumberError = function (message) {
    this.name = 'ExpectedNumberError';
    this.message = (message || '');
};

ExpectedNumberError.prototype = new Error();
ExpectedNumberError.prototype.constructor = ExpectedNumberError;


        var RPC = function(){this.a=1;};

RPC.prototype.rpcCall = function(func, argArr, cb, due){
    this.a++;
    due =500;
    var dueTimeout = setTimeout(function(){
        clearTimeout(cbTimeout);
        var err= new TimeOutError();
        cb(err);
    }, due);

    var cbTimeout = setTimeout(function(){
        clearTimeout(dueTimeout);
        var celcius = argArr[0];
        
        //APPLICATION CODE
        var fahrenheit = convert(celcius);
        if(fahrenheit){
            cb(null, fahrenheit);
        }else{ //NaN
            var err = new ExpectedNumberError('\'' + celcius + '\' is not a number.');
            cb(err);
        }
        //APPLICATION CODE

    }, Math.floor((Math.random() * 1000) + 1));
    return func;
};

// Actual application code...
//APPLICATION CODE
{
    var convert = function(celcius){
        return celcius * factor() + add;
    };

    var factor = function () {
        return 9 / 5;
    };
    var add = 32;

}
//APPLICATION CODE

var r = new RPC();

var a = makeFailureProxy(r, new CallA());
var b = makeFailureProxy(r, new CallB()); 

//var a = makeFailureProxy(r, new BlockNode());
//var b = makeFailureProxy(r, new CallB());



var counter = 5;

/*b.rpcCall('abc', [5], function AA(err, res){
    counter++;
    console.log(counter);
});*/



    </script>
</body>
</html>