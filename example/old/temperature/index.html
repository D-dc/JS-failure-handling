<!doctype html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Temperature</title>

</head>

<body>
    <h2>Temperature</h2>
    <i>original example <a href="http://soft.vub.ac.be/~lphilips/jspdg/stip/stip-web/stip.html">here</a>.</i>
    <p>
        Convert Celcius to Fahrenheit.
    </p>
    <p>
        <input type="text" value="" placeholder="temperature in Celcius" id="tmp" />
        <input type="submit" id="submit" />
    </p>
    <p id="txt"></p>

    <!-- Proxy implementation code -->
    <script src="../../code.js"></script>

    <!-- Proxies definition -->
    <script src="proxy.js"></script>

    <!-- Server-side application code -->
    <script src="application.js"></script>

    <!-- Client-side application code -->
    <script>
    'use strict'

    var button = document.getElementById('submit');
    var r = new RPC();
    var l = makeLogProxy(makeApplicationErrorProxy(makeNetworkErrorProxy(r)));

    button.addEventListener('click', function() {
        {
            l.rpcCall('temperature', [read('tmp')], function(err0, res0) {

                print('tmp', res0 + ' Fahrenheit');
                if (res0 > 68)
                    print('txt', 'It is rather hot today');
                else
                    print('txt', 'It is rather cold today');
            }, 500);

            /*l.rpcCall('temperature', [10], function(err0, res0) {
                console.log('2nd call');
            }, 500);*/
        }

    });
    </script>

    <!-- STiP tierless primitives (not actual implementation) -->
    <script>
    'use strict'

    var read = function(element) {
        return document.getElementById(element).value;
    };

    var print = function(element, text) {

        var el = document.getElementById(element);
        if (el.value)
            el.value = text;
        else
            el.innerHTML = text;

        return element;
    };
    </script>
</body>
</html>